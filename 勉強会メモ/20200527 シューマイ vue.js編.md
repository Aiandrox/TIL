https://shuuu-mai.connpass.com/event/174860/?utm_campaign=event_message_to_selected_participant&utm_source=notifications&utm_medium=email&utm_content=title_link

## これからの「設計」の話をしよう

経営課題
- 運用の負荷を下げたい
- 管理が全て手作業、属人化

第二新卒の人にPMをさせる
- ヤバイ

原因
- ドメインの知識
- 実務と結びつかない
- 仕様が複雑なことにすら気づかない
- ビジネスサイドの巻き込みが必要
- スキル不足

- 役割を決める
- 管理
- ステークホルダーを巻き込む
  - **RDRA × DDD**
- ちゃんと実装

PDRA
- 要件分析
- 関係性を持ったモデル
- 要件からシステムまで矛盾がない

先にビジネスユースケースの整備が必要

このへんから「ほえ〜」って感じ。よくわからん  
なんか実際の動きをモデルとして落とし込むみたいな感じなのかね？
全部の動きをER図にしていた。

あっ見たことある図。コーディングアーキテクチャ

その他やったこと  
- ドメインモデルの理解を必須とした
- スプリントMTGで細かく共有
- 全体ロードマップをスプリントごとに修正

→チームが自己組織化して自走するようになった


### 学び
- わかりきっていると思っていることも図にすると案外複雑
- 自分と他人の常識は違う
- 原因分析、その場に応じた戦略的な設計、開発手法
- 一歩引いて状況把握
  - プレイヤーとしてだと見づらい


### 設計スタイルの選び方も大事！！

### Q & A

Q. DDDによりフロントエンジニアがドメインの理解が促進、すごく良い話でした！自己組織化、成長、すごく良い話過ぎて本当？と思ってしまいました(笑。劇的な変革だったと思いますが、大変だったことはありますか？  
A. 一人エンジニアがやめた。組織の変革により、合わないという人がやめた。色を強くすると近づくか離れるか二極化する。  
分報がめちゃくちゃ速い。1日100回くらい。  
→困っていることを助けてくれたり、今日飲みに行こうぜとか雑談とか。

Q. フロントエンドでDDDアーキテクチャを導入した時のパッケージ構成などは具体的にどういった感じでしょうか？フロントエンドのパッケージ構成などで少し課題を感じているのでお聞きしたいです。   
A. Model, Form, Repositoryuなどなど？入力とデータが少し変わるので、フォームを中間にはさんだ。
分け方のジャンルはサービスごとorレイヤーごと。今は後者でやってる。

Q. DDDアーキテクチャ導入を決めた際に参考にした、決め手となった事例とかあったりしますか？  
A. 失敗の二の舞。前職で崩壊したときに交代したメンバーがDDDと叫んでいて、それを取り入れてうまく行った実績があったので。

Q. TypeScriptは導入されていますか？また、サーバサイドとのモデルの齟齬が起きないような工夫などされていますでしょうか？  
A. TS悩んだけどできなかった。みんなJSの経験しかなかったからそのまま……計画はしているがタスクがあてられていない。  
若干齟齬が起きることはある。TSにしたらよくなると思う……。モデルを分けることでそれぞれ確認している。


## 実務における Vue.js と Atomic Design

導入してどうなったか
- AtomicDesignを共通言語に
- CSSも設計も一新　再現性↑
- **Storybook**もコンポーネントもカタログ化
  - CircleCIで見れる（すごい）

BEMを導入
- Scopedだからといって適当にするとslotで死ぬ（slotはどっちが適用されるのだ？）

でかいコンポーネントは再現性が低い
- AtmicDesignの明確な指針

CSSがふかーい階層
→各コンポーネントでCSSが価格れるので階層も浅くできた！


> わからないワード　Storybook（なんかめっちゃ便利そう）


### Q & A

Q. Atomic Design を導入したのはデザイナーではなくてエンジニアでしょうか？弊社でも Storybook を導入していますが、デザイナーとエンジニアのコミュニケーションツールとなっておりません・・。何かコツ等ありましたら教えて頂ければ幸いです。  
A. Yes.デザインをかじっているフロントエンド。最初にアトミックで分割して、元々ある画面から手を付ける。こんな感じで分割して共通化するよ、とする。

Q. 大変だったこと
A. 既存の切り分け方。神に印刷して線を引いたりとか。  
モルキュール、オーガニズムの判断基準の統一。

Q. Atmic Designを使用すると、pagesで使用しているコンポーネントのpropsとv-onがもの凄い量になるのですが、そういうモノでしょうか？それか、上手い工夫の仕方などありますでしょうか？  
A. 悩みどころだな。コンポーネント側で通信させるやり方もあるけど、模索中

Q. これはmoleculeだよねとかこれはorganismだよねみたいなアドバイスはすでにアトミックデザインに知見のある方がいてリードしていった感じですか？  
A. 知見がある人がリードしていった。

Q. ストーリーブックはかなりメンテナンスにコストがかかるイメージですが、メンテナンスのナレッジが有れば教えていただきたいです  
A. が ん ば る 。

Q. Vuexは使用されていますか？使用されている場合、Atomic Designにおいて、Vuexを利用するレイヤーは決めていますでしょうか？  
A. 利用するレイヤーは決めている。オーガニズムかページのみ。別のコンポーネントを作成してそこから叩く。（ちょっとここの意味がわからん）


## 大規模サービスをNuxt.jsで作り変えた感想

ぅゎぁっょっょだぁ。

### 大規模を作るに至った理由

- ECプラットフォームからのリニューアル
  - 技術のせいでビジネスが頭打ちになってしまうから
- 機能が大規模

Nuxt.js, MongoDB, AWS, S3, Github actions などなど
- 機能が大規模

### なぜNuxt

- SSR
- express.jsと同居
- 学習コストの低さ
- 規約がしっかりしている
- 汎用的な設計
- Reactiveの万能さ（再描画が詰まることが少ない）

### 注意点

- メソッドの設計、共通化
  - むやみに実装に走る（できます）とそれぞれがオレオレ手法を使って破綻
  - 関数型言語のフィロソフィーを利用（ひとつのメソッドにメソッドをフィルターみたいな重ねて濾していくイメージなのかな）
- pages, storeの設計
  - SRやmountedで必要なときに必要なだけデータを取得
  - storeでview管理ごりごり☓
  - 楽＝正しい設計かどうか精査
- APIエンドポイントの設計
  - 各Viewとサーバーサイドの理解・共通認識
  - レスポンスやリクエストパラメータを統一
  - →サーバー側の処理も統一
  - MTG妥協ダメ絶対。
- GA, GTM, optimize
  - マーケターとMTGを入れよう
  - SPAの理解からしてもらう
  
### 感想

- コードレビューが楽になった。
- eslint, sentryを入れないと地獄
  - ローカルでよくても本番でエラーなことがある
  - 開発者が増える前、ジョインするタイミングでコード規約をしっかり！
- 採用がしやすい、成長させやすい


### Q & A

Q. サーバーとフロントのすり合わせというのは、例えば1画面1APIで実現するにはどうすればよいか？みたいな話ですか？  
A. エンドポイントベース。フロントではなるべくロジックを持たない。ディレクトリ構造を統一させたり。

Q. vue3に向けて何か準備されていることはありますか？  
A. そんなに。

Q. Vuexを経由しないREST APIのコールなどはされていますか？  
A. 基本的にはStoreを通すけど保管はしない。（えっAPI叩くのってVuex通してするものなの？？）  
Q. なるべくstoreを利用しないというのはさきほどのデータ不一致をできる限り避けるためという理解であってますかね？
A. そう。

Q. 中学生からプログラミングを学習していたきっかけは？  
A. プログラミングとしてではなく、オンラインゲームのチームのホームページを作ったりからスタート

Q. React+Nextと比較してVue+Nuxtの良い点と悪い点はどんなところがありますか？  
A. Nextは使ったことないけど、構成としては似たようなものではなかろうか。


## Vue.jsのない会社にVue.jsを入れていく

以前  
エンジニアはバック/フロントで横一列って感じ
→専門性を伸ばした方がいい  
→スーパーマンを求める　採用しづらい  

Vueを入れる→フロントエンド組織を作る　ということになった

- フロントエンドエンジニアのロールって何？
  - どこまで触る？API, Docker, AWS, CI/CDの設定
  - 明確にすべきは、フロント/バック/デザインの重なる部分。**何を協力して向き合うべきか**
  - APIモックを整備、ビルドシステムに責任を持つ、APIの開発は原則しない、デザイナーにコーディングをさせない（境界の分離）
  - ときには越境も。メンバーのスキル、関心↑
- 冪等性
  - 後でいいや問題
    - ビルド時間、デプロイの自動化、コンポーネント、ルール
  - いつでも同じ結果を得られる状況を作る。とりあえずCIでテストは回る状況
- Vue Appのパフォーマンス管理がむずかしい
  - 逐次対応はキリがない。疲弊する
  - 正常稼働を担保する指標
   - ロギングによる可視化とモニタリング

### まとめ

- ロールのかぶるところを考える必要がある
- フロントは異常が見えにくいので指標を作る

### Q & A

Q. Can all RareJob's employees speak English?  
A. 日本では日本語。フィリピンでは英語。

Q. Vue はあまり関係ないですが Redash ってクエリがよく詰まって運用が大変なイメージありますが何かコツはありますか?  
A. まじでそう。Botが参照するデータでも詰まる。そういうものだという前提。  
適宜分けている。サービスごとだったり

Q. Vue導入の際に勉強会などメンバーの知見を増やしいく取り組みなどは行われたのでしょうか？実施された取り組みが気になるところです。  
A. やってたけど、初期は有志や業務委託。採用はVueの経験のある人を採っていた。コーディングテストも

Q. 導入初期は「Vueを導入したくない」という声はありましたか  
A. 無関心はあった。既存のサイトを置き換えるハンズオン、テックブログでメリットを共有化
